"use strict";
import{u as e}from"../../../../_virtual/use-intersection.js";import"../../../react/index.js";import"./request-idle-callback.js";import{r as t}from"../../../../_virtual/index.js";import{r}from"../../../../_virtual/request-idle-callback.js";!function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"useIntersection",{enumerable:!0,get:function(){return a}});const o=t.exports,s=r.exports,i="function"==typeof IntersectionObserver,u=new Map,l=[];function c(e,t,r){const{id:n,observer:o,elements:s}=function(e){const t={root:e.root||null,margin:e.rootMargin||""},r=l.find((e=>e.root===t.root&&e.margin===t.margin));let n;if(r&&(n=u.get(r),n))return n;const o=new Map,s=new IntersectionObserver((e=>{e.forEach((e=>{const t=o.get(e.target),r=e.isIntersecting||e.intersectionRatio>0;t&&r&&t(r)}))}),e);return n={id:t,observer:s,elements:o},l.push(t),u.set(t,n),n}(r);return s.set(e,t),o.observe(e),function(){if(s.delete(e),o.unobserve(e),0===s.size){o.disconnect(),u.delete(n);const e=l.findIndex((e=>e.root===n.root&&e.margin===n.margin));e>-1&&l.splice(e,1)}}}function a(e){let{rootRef:t,rootMargin:r,disabled:n}=e;const u=n||!i,[l,a]=(0,o.useState)(!1),f=(0,o.useRef)(null),d=(0,o.useCallback)((e=>{f.current=e}),[]);(0,o.useEffect)((()=>{if(i){if(u||l)return;const e=f.current;if(e&&e.tagName){return c(e,(e=>e&&a(e)),{root:null==t?void 0:t.current,rootMargin:r})}}else if(!l){const e=(0,s.requestIdleCallback)((()=>a(!0)));return()=>(0,s.cancelIdleCallback)(e)}}),[u,r,t,l,f.current]);const b=(0,o.useCallback)((()=>{a(!1)}),[]);return[d,l,b]}("function"==typeof n.default||"object"==typeof n.default&&null!==n.default)&&void 0===n.default.__esModule&&(Object.defineProperty(n.default,"__esModule",{value:!0}),Object.assign(n.default,n),e.exports=n.default)}(e,e.exports);
//# sourceMappingURL=use-intersection.js.map
